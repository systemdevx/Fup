<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes da Requisição</title>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <link rel="stylesheet" href="novo_pedido5.css">
</head>
<body>

    <div class="actions-bar">
        <div class="left-actions">
            <button class="action-btn" onclick="window.location.href='transacoes.html'">
                <span class="material-icons-outlined">arrow_back</span> Voltar
            </button>

            <div class="dropdown-container">
                <button class="action-btn" id="btnMaisOpcoes">
                    <span class="material-icons-outlined">more_horiz</span> Mais opções 
                    <span class="material-icons" style="font-size:18px;">arrow_drop_down</span>
                </button>
                <div class="dropdown-menu" id="menuMaisOpcoes">
                    <div class="dropdown-item" id="btnActionEditar">
                        <span class="material-icons-outlined">edit</span> Editar
                    </div>
                    <div class="dropdown-item" id="btnActionCancelarItens">
                        <span class="material-icons-outlined">remove_circle_outline</span> Cancelar Itens
                    </div>
                </div>
            </div>
        </div>
        
        <div class="right-actions">
            <button class="action-btn" onclick="window.print()">
                <span class="material-icons-outlined">print</span> Imprimir / Logs
            </button>
            <button class="action-btn btn-cancelar" id="btnCancelarPedidoTrigger">
                <span class="material-icons-outlined">highlight_off</span> Cancelar Requisição
            </button>
        </div>
    </div>

    <div class="main-container">
        
        <div id="successBanner" class="success-banner" style="display: none;">
            <div class="banner-content">
                <span class="material-icons">check_circle</span>
                <div>
                    <strong>Requisição enviada com sucesso!</strong><br>
                    Sua requisição <span id="bannerId">...</span> foi criada e segue para aprovação.
                </div>
            </div>
            <button class="close-banner" onclick="this.parentElement.style.display='none'">
                <span class="material-icons">close</span>
            </button>
        </div>

        <div class="hero-section">
            <div class="id-box">
                <span class="id-label">Requisição</span>
                <span class="id-value" id="viewId">ME# ...</span>
            </div>
            
            <div class="hero-info">
                <div class="hero-title" id="viewTitulo">...</div>
                <div class="hero-subtitle">VIVARA MATRIZ E FILIAIS LTDA.</div>
                <div class="hero-user">
                    <span class="material-icons-outlined user-icon">person</span>
                    <span id="viewRequisitante">...</span>
                </div>
            </div>

            <div class="hero-status">
                <div class="status-badge" id="viewStatus">...</div>
                <div class="created-date" id="viewDataCriacao">...</div>
            </div>
        </div>

        <div class="address-row">
            <div class="address-card">
                <div class="card-header-label">Entrega</div>
                <div class="card-code" id="viewLocalEntrega">...</div>
                <div class="address-lines">
                    <p><span class="icon-tiny material-icons-outlined">badge</span> CNPJ: 26013023000124</p>
                    <p><span class="icon-tiny material-icons-outlined">place</span> <span id="viewEnderecoEntrega">...</span></p>
                </div>
            </div>
            <div class="address-card">
                <div class="card-header-label">Faturamento</div>
                <div class="card-code" id="viewLocalFat">...</div>
                <div class="address-lines">
                    <p><span class="icon-tiny material-icons-outlined">badge</span> CNPJ: 84453844003608</p>
                    <p><span class="icon-tiny material-icons-outlined">place</span> <span id="viewEnderecoFat">...</span></p>
                </div>
            </div>
        </div>

        <div class="section-block">
            <div class="section-title" onclick="toggleSection(this)">
                <span class="material-icons-outlined toggle-orange">expand_less</span> 
                Informações Gerais
            </div>
            <div class="info-grid content-section">
                <div class="field-box"><label>Título</label><span id="infoTitulo">...</span></div>
                <div class="field-box"><label>Requisitante</label><span id="infoRequisitante">...</span></div>
                <div class="field-box"><label>Nº Documento ME</label><span id="infoMeId">...</span></div>
                <div class="field-box"><label>Categoria</label><span>CCI CONIPA</span></div>
                <div class="field-box"><label>Empresa</label><span>3000 - CONIPA</span></div>
                <div class="field-box"><label>Centro de Custos</label><span id="infoCC">...</span></div>
                <div class="field-box"><label>Valor Total</label><span id="infoTotal" style="font-weight: 700;">...</span></div>
                
                <div class="field-box full">
                    <label>Anexo</label>
                    <span class="attachment-link" id="viewAnexoContainer">
                        <span class="material-icons-outlined" id="iconAnexoView">attach_file</span> 
                        <span id="txtAnexoView">Nenhum anexo existente.</span>
                    </span>
                </div>
            </div>
        </div>

        <div class="section-block">
            <div class="section-title" onclick="toggleSection(this)">
                <span class="material-icons-outlined toggle-orange">expand_less</span> 
                Histórico De Aprovações
            </div>
            <div class="content-section" style="padding: 10px 0 0 35px;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom: 5px;">
                    <span class="material-icons" style="font-size:20px; color:#E67E22;">check_circle</span>
                    <span style="font-size:14px; color:#444;" id="txtHistoricoCriacao">Solicitação criada com sucesso</span>
                </div>
                <div id="historicoStatusAtual" style="display:flex; align-items:center; gap:10px;">
                    <span class="material-icons" style="font-size:20px; color:#999;">radio_button_unchecked</span>
                    <span style="font-size:14px; color:#777;">Aprovação Gerência (Pendente)</span>
                </div>
            </div>
        </div>

        <div class="section-block">
            <div class="section-title" onclick="toggleSection(this)">
                <span class="material-icons-outlined toggle-orange">expand_less</span> 
                Itens (<span id="cntItens">0</span>) 
            </div>
            
            <div class="table-container content-section">
                <div class="table-items-header">
                    <div class="t-col-idx">#</div>
                    <div class="t-col-code">Código Produto</div>
                    <div class="t-col-desc">Descrição</div>
                    <div class="t-col-un" style="text-align:center;">Unidade</div>
                    <div class="t-col-qtd" style="text-align:center;">Qtde</div>
                    <div class="t-col-price">Preço Unit.</div>
                    <div class="t-col-total">Valor Total</div>
                    <div class="t-col-actions">Status</div>
                </div>
                <div id="listaItensFinal"></div>
            </div>
        </div>
    </div>

    <div id="modalCancelOrder" class="modal-overlay" style="display: none;">
        <div class="modal-box">
            <div class="modal-header">
                <span class="material-icons-outlined modal-icon-discrete">warning</span>
                <h3>Cancelar Requisição</h3>
            </div>
            <p>Tem certeza que deseja cancelar esta requisição inteira?</p>
            
            <div class="modal-body-input">
                <label for="txtJustificativa">Justificativa do cancelamento <span style="color:red">*</span></label>
                <textarea id="txtJustificativa" class="modal-textarea" placeholder="Digite o motivo aqui..."></textarea>
            </div>

            <div class="modal-actions">
                <button id="btnModalCloseOrder" class="modal-btn modal-btn-cancel">Não, Voltar</button>
                <button id="btnModalConfirmOrder" class="modal-btn modal-btn-confirm">Sim, Cancelar</button>
            </div>
        </div>
    </div>

    <script src="novo_pedido5.js"></script>
</body>
</html>